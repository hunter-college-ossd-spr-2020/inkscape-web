{% extends 'person/base.html' %}
{% load user_session i18n future %}


{% block content %}

  <div id="right-sidebar" class="profileside">
    <h1><a href="{% url "flat_resources" user.id %}">{% trans "All Uploads" %}</a></h1>
    {% if user.details.gpg_key %}
    <h1><a href="{% url "user_gpgkey" user.username %}">{% trans "Public GPG Key" %}</a></h1>
    {% endif %}
    <h1><a href="{% url "user_category" user.id 1 %}">{% trans "PasteBin" %}</a></h1>
    {% if me %}
     <div id="paste">
      <form method="POST" action="{% url "pastebin" %}">
        {% csrf_token %}
        <textarea name="download" placeholder="{% trans "Paste Your Bin Here..." %}"></textarea>
        <input type="submit" value="{% trans "Paste!" %}"/>
      </form>
     </div>
    {% else %}
      <h1>{% trans "Last Seen" %}</h1>
      <p>{% if user.details.last_seen %}{% blocktrans with user.details.last_seen|timesince as time_since %}{{time_since}} ago{% endblocktrans %}{% else %}{% trans "Never" %}{% endif %}</p>

      <h1>{% trans "Joined On" %}</h1>
      <p>{{ user.date_joined }}<br/>{% blocktrans with user.date_joined|timesince as time_since%}{{time_since}} ago{% endblocktrans %}</p>
    {% endif %}

    <h1>{% trans "Stats" %}</h1>
    <table>
      <tr><th scope="col">{% trans "Profile Visits:" %}</th><td>{{ user.details.visits }}</td></tr>
      <tr><th scope="col">{% trans "Resource Views:" %}</th><td>{{ user.resources.views }}</td></tr>
      <tr><th scope="col">{% trans "Resource Downloads:" %}</th><td>{{ user.resources.downloads }}</td></tr>
    </table>
   {% if me %}

    <h1>{% trans "Upload Quota" %}</h1>
    <progress value="{{ user.resources.disk_usage }}" max="{{ user.quota }}" title="{{ user.resources.disk_usage|filesizeformat }} {% trans "of" %} {{ user.quota|filesizeformat }}"></progress>

     <h1 title="{% trans "Sessions are stored only as long as you are logged in and the IP address is not recorded permanently."%}">{% trans "Sessions" %}</h1>
     <div id="sessions">
     {% for session in user.sessions %}
         <div>
           <div class="OS {{ session.user_agent|device_id }} {{ session.user_agent|device_id:True }}" title="{{ session.user_agent|device }}">&nbsp;</div>
           <div class="BR {{ session.user_agent|browser_id }}" title="{{ session.user_agent|browser }}">&nbsp;</div>
           <span title="{{ session.ip }} / {% blocktrans with session.last_activity|timesince as time_since%}{{time_since}} ago{% endblocktrans %}">{{ session.ip|location }}</span>
         </div>
     {% endfor %}
     </div>
   {% else %}
    <!--<form method="POST" action="{% url "alert.subscribe" "user-gallery" user.pk %}">
      {% csrf_token %}
      <input type="submit" value="{% trans "Subscribe" %}"/>
    </form>-->
   {% endif %}
</div>

<h1>InkSpaces - {% trans "A Place to Upload" %}</h1>
{% include "resource/galleries.html" %}

{% if user.favorites.all %}
  <h1>{% trans "Favorite Artworks" %}</h1>
  {% with 4 as limit %}
    {% with user.favorites.items as items %}
      {% include "resource/list.html" %}
    {% endwith %}
  {% endwith %}
{% endif %}

{% endblock %}
