{% extends 'base.html' %}
{% load static sekizai_tags i18n %}

{% block title %}Download {{ object }}{% endblock %}

{% block supercontent %}

{% addtoblock "css" %}
  <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/shield.css"/>
  <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/releases.css"/>
{% endaddtoblock %}

<div id="shield" class="download">
  <div id="banners"
    {% if object.background %}
      style="background-image:url({{ object.background.url }})"
    {% elif parent.background %}
      style="background-image:url({{ parent.background.url }})"
    {% endif %}>
    {% for tab in object.tabs %}
      <div {% if platform == tab.uuid %}class="current"{% endif %}>
          <div>
              <ul>
                {% for child in tab.filtered %}
                  <li class="child">
                      {% if child.icon %}
                          <img src="{{ child.icon.url }}">
                      {% else %}
                          <img src="{% static "images/releases/icon.png" %}">
                      {% endif %}
                      {{ child.name }}
                      <ul>
                        {% for subchild in child.filtered %}
                        <li class="platform" tabindex="{{ forloop.counter0 }}">
                          <p>{{ subchild.name }}</p>
                          <div>
                            {% if subchild.image %}
                            <img src="{{ subchild.image.url }}" title="{{ child }}"/>
                            {% elif child.image %}
                              <img src="{{ child.image.url }}" title="{{ child }}"/>
                            {% endif %}
                            <p>
                              {% if subchild.release.download %}
                                <a href="{{ subchild.release.download }}">Download</a>
                              {% else %}
                                <span>No Download Available</span>
                              {% endif %}
                              {% if subchild.release.more_info %}
                                <a href="{{ subchild.release.more_info }}">More Info</a>
                              {% endif %}
                              {% if subchild.release.howto %}
                                <a href="{{ subchild.release.howto }}">Detailed Instructions</a>
                              {% endif %}
                            </p>
                          </div>
                        </li>
                        {% endfor %}
                      </ul>
                  </li>
                {% endfor %}
              </ul>
          </div>
      </div>
    {% endfor %}
  </div>
  <ul class="tabs">
    {% for tab in object.tabs %}
      <li {% if platform == tab.uuid %}class="current"{% endif %} data-matcher="{{ tab.matcher }}">
        <a href="#{{ tab.uuid }}"><strong>{{ tab.tab_name }}</strong>
          {% if tab.tab_cat.icon %}
            <img src="{{ tab.tab_cat.icon.url }}"/>
          {% endif %}
          {{ tab.tab_text }}
        </a>
      </li>
    {% endfor %}
  </ul>
</div>

  <div id="left-column" class="notes">
    <h2>Release Notes</h2>
    <p>{{ object.release_notes|safe|default:"No Release Notes" }}</p>
  </div>

  <div id="right-sidebar" class="releases">
    <div id="sidecategory">
      <h1>{{ object }}</h1>
      <h2>{% trans "Responsible People" %}</h2>
      <ul>
        <li>
          {% if object.manager %}
            <label>{% trans "Manager" %}:
              <a href="{{ object.manager.get_absolute_url }}">{{ object.manager }}</a>
            </label>
          {% else %}
            <label>{% trans "No Manager" %}</label>
          {% endif %}
        </li>
        <li>
          {% if object.reviewer %}
            <label>{% trans "Reviewer" %}:
              <a href="{{ object.reviewer.get_absolute_url }}">{{ object.reviewer }}</a>
            </label>
          {% else %}
            <label>{% trans "No Reviewer" %}</label>
          {% endif %}
        </li>
        <li>
          <a href="{% url "platforms" %}">
            <label>Platform Managers...</label>
          </a>
        </li>
      </ul>
    {% if parent.revisions.count > 1 %}
      <h2>{% trans "Other Revisions" %}</h2>
      {% include "releases/release_sidelist.html" with objs=parent.revisions obj=object %}
    {% endif %}
    {% if releases.count > 1 %}
      <h2>{% trans "Versions" %}</h2>
      {% include "releases/release_sidelist.html" with objs=releases obj=parent latest=True %}
    {% endif %}
    {% if development.count > 0 %}
      <h2>{% trans "In Development" %}</h2>
      {% include "releases/release_sidelist.html" with objs=development obj=object latest=True %}
    {% endif %}
    </div>
  </div>
{% endblock %}
